<%= form_for [:admin, @train, @carriage.becomes(Carriage)] do |form| %>
  <% if carriage.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(carriage.errors.count, "error") %> prohibited this route from being saved:</h2>

      <ul>
        <% carriage.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :type %>
    <%= form.select(:type, Carriage::CARRIAGE_TYPES, selected: @carriage.type || 'DefaultCarriage') %>
  </div>

  <div class="field" id="top_seats">
    <%= form.label :top_seats %>
    <%= form.number_field :top_seats %>
  </div>
  <div class="field" id="bottom_seats">
    <%= form.label :bottom_seats %>
    <%= form.number_field :bottom_seats %>
  </div>

  <div class="field" id="side_top_seats">
    <%= form.label :side_top_seats %>
    <%= form.number_field :side_top_seats %>
  </div>
  <div class="field" id="side_bottom_seats">
    <%= form.label :side_bottom_seats %>
    <%= form.number_field :side_bottom_seats %>
  </div>
  <div class="field" id="sitting_seats">
    <%= form.label :sitting_seats %>
    <%= form.number_field :sitting_seats %>
  </div>

  <div>
    <%= form.label 'Train number:' %>
    <%= form.collection_select :train_id, Train.all, :id, :number %>
  </div>

  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>
<script>
    jQuery(document).ready(function($) {

        $(document).ready(function () {
        console.log('123');
        $('.seats').hide();
        show_carriage_attr($('#carriage_type').val());

        $('#carriage_type').on('change', function (e) {
            $(".seats input").val("");
            $('.seats').hide();
            show_carriage_attr(e.target.value);
        });

        function show_carriage_attr(type) {
            switch (type) {
                case 'DefaultCarriage':
                    $('#sitting_seats').hide();
                    $('#top_seats').show();
                    $('#bottom_seats').show();
                    $('#side_top_seats').show();
                    $('#side_bottom_seats').show();
                    break;
                case 'CoupeCarriage':
                    $('#sitting_seats').hide();
                    $('#top_seats').show();
                    $('#bottom_seats').show();
                    $('#side_top_seats').hide();
                    $('#side_bottom_seats').hide();
                    break;
                case 'PremiumCarriage':
                    $('#sitting_seats').hide();
                    $('#top_seats').hide();
                    $('#bottom_seats').show();
                    $('#side_top_seats').hide();
                    $('#side_bottom_seats').hide();
                    break;
                case 'SittingCarriage':
                    $('#sitting_seats').show();
                    $('#top_seats').hide();
                    $('#bottom_seats').hide();
                    $('#side_top_seats').hide();
                    $('#side_bottom_seats').hide();
                    break;
            }
        };
    })
    });
</script>
